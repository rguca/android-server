# Generated by iptables-save v1.8.7 on Fri Sep 29 18:29:03 2023
*security
:INPUT ACCEPT [184120:21271729]
:FORWARD ACCEPT [3299689:2962626300]
:OUTPUT ACCEPT [166074:17944375]
COMMIT
# Completed on Fri Sep 29 18:29:03 2023
# Generated by iptables-save v1.8.7 on Fri Sep 29 18:29:03 2023
*raw
:PREROUTING ACCEPT [23240:2046295]
:OUTPUT ACCEPT [5751:1010102]
:bw_raw_PREROUTING - [0:0]
:clat_raw_PREROUTING - [0:0]
:idletimer_raw_PREROUTING - [0:0]
:nm_mdmprxy_raw_pre - [0:0]
:qcom_htimer_PREROUTING - [0:0]
:tetherctrl_raw_PREROUTING - [0:0]
-A PREROUTING -j qcom_htimer_PREROUTING
-A PREROUTING -j clat_raw_PREROUTING
-A PREROUTING -j bw_raw_PREROUTING
-A PREROUTING -j idletimer_raw_PREROUTING
-A PREROUTING -j tetherctrl_raw_PREROUTING
-A bw_raw_PREROUTING -i ipsec+ -j RETURN
-A bw_raw_PREROUTING -m policy --dir in --pol ipsec -j RETURN
-A bw_raw_PREROUTING -m owner --socket-exists
-A idletimer_raw_PREROUTING -i rmnet_data0 -j IDLETIMER --timeout 10 --label 0
-A nm_mdmprxy_raw_pre -p tcp -m multiport --ports 5060 -j NOTRACK
-A nm_mdmprxy_raw_pre -p udp -m multiport --ports 5060 -j NOTRACK
-A tetherctrl_raw_PREROUTING -i wlan0 -p tcp -m tcp --dport 21 -j CT --helper ftp
-A tetherctrl_raw_PREROUTING -i wlan0 -p tcp -m tcp --dport 1723 -j CT --helper pptp
COMMIT
# Completed on Fri Sep 29 18:29:03 2023
# Generated by iptables-save v1.8.7 on Fri Sep 29 18:29:03 2023
*nat
:PREROUTING ACCEPT [991:93183]
:INPUT ACCEPT [559:33948]
:OUTPUT ACCEPT [342:23763]
:POSTROUTING ACCEPT [0:0]
:oem_nat_pre - [0:0]
:tetherctrl_nat_POSTROUTING - [0:0]
-A PREROUTING -j oem_nat_pre
-A POSTROUTING -o rmnet0 -j MASQUERADE
-A POSTROUTING -j tetherctrl_nat_POSTROUTING
-A tetherctrl_nat_POSTROUTING -o rmnet_data0 -j MASQUERADE
COMMIT
# Completed on Fri Sep 29 18:29:03 2023
# Generated by iptables-save v1.8.7 on Fri Sep 29 18:29:03 2023
*mangle
:PREROUTING ACCEPT [23240:2046295]
:INPUT ACCEPT [7310:673960]
:FORWARD ACCEPT [15646:1249431]
:OUTPUT ACCEPT [5751:1010102]
:POSTROUTING ACCEPT [21253:2248417]
:bw_mangle_POSTROUTING - [0:0]
:idletimer_mangle_POSTROUTING - [0:0]
:nm_mdmprxy_icmp_pkt_marker - [0:0]
:nm_mdmprxy_mark_prov_chain - [0:0]
:nm_mdmprxy_mngl_post - [0:0]
:nm_mdmprxy_mngl_pre_ex - [0:0]
:nm_mdmprxy_mngl_pre_spi - [0:0]
:nm_mdmprxy_mngl_pre_tee - [0:0]
:nm_mdmprxy_pkt_forwarder - [0:0]
:nm_mdmprxy_pkt_marker - [0:0]
:nm_mdmprxy_pkt_skmark - [0:0]
:oem_mangle_post - [0:0]
:qcom_htimer_POSTROUTING - [0:0]
:qcom_qos_filter_POSTROUTING - [0:0]
:qcom_qos_reset_POSTROUTING - [0:0]
:routectrl_mangle_INPUT - [0:0]
:tetherctrl_mangle_FORWARD - [0:0]
:wakeupctrl_mangle_INPUT - [0:0]
-A INPUT -j wakeupctrl_mangle_INPUT
-A INPUT -j routectrl_mangle_INPUT
-A FORWARD -j tetherctrl_mangle_FORWARD
-A POSTROUTING -j qcom_htimer_POSTROUTING
-A POSTROUTING -j oem_mangle_post
-A POSTROUTING -j bw_mangle_POSTROUTING
-A POSTROUTING -j idletimer_mangle_POSTROUTING
-A POSTROUTING -j qcom_qos_reset_POSTROUTING
-A POSTROUTING -j qcom_qos_filter_POSTROUTING
-A bw_mangle_POSTROUTING -o ipsec+ -j RETURN
-A bw_mangle_POSTROUTING -m policy --dir out --pol ipsec -j RETURN
-A bw_mangle_POSTROUTING -j MARK --set-xmark 0x0/0x100000
-A bw_mangle_POSTROUTING -m owner --uid-owner 1029 -j RETURN
-A bw_mangle_POSTROUTING -m owner --socket-exists
-A idletimer_mangle_POSTROUTING -o rmnet_data0 -j IDLETIMER --timeout 10 --label 0
-A nm_mdmprxy_mark_prov_chain -p udp -m socket --transparent --nowildcard --restore-skmark -j nm_mdmprxy_pkt_skmark
-A nm_mdmprxy_mark_prov_chain -p tcp -m socket --transparent --nowildcard --restore-skmark -j nm_mdmprxy_pkt_skmark
-A nm_mdmprxy_mngl_post -m mark --mark 0xf0002 -j MARK --set-xmark 0x0/0xffffffff
-A nm_mdmprxy_mngl_pre_ex -p tcp -m tcp --dport 50010:50060 -j MARK --set-xmark 0xf0002/0xffffffff
-A nm_mdmprxy_mngl_pre_ex -p udp -m udp --dport 50010:50060 -j MARK --set-xmark 0xf0002/0xffffffff
-A nm_mdmprxy_mngl_pre_ex -p tcp -m tcp --dport 32100:32600 -j MARK --set-xmark 0xf0002/0xffffffff
-A nm_mdmprxy_mngl_pre_ex -p udp -m udp --dport 32100:32600 -j MARK --set-xmark 0xf0002/0xffffffff
-A nm_mdmprxy_mngl_pre_ex -p tcp -m tcp --dport 40100:40150 -j MARK --set-xmark 0xf0002/0xffffffff
-A nm_mdmprxy_pkt_marker -j CONNMARK --restore-mark --nfmask 0xffffffff --ctmask 0xffffffff
-A nm_mdmprxy_pkt_marker -j nm_mdmprxy_mark_prov_chain
-A nm_mdmprxy_pkt_marker -j nm_mdmprxy_mngl_pre_spi
-A nm_mdmprxy_pkt_marker -j nm_mdmprxy_mngl_pre_ex
-A nm_mdmprxy_pkt_marker -p udp -m udp --dport 7275 -j MARK --set-xmark 0xf0002/0xffffffff
-A nm_mdmprxy_pkt_marker -p tcp -m tcp --dport 5060 -j MARK --set-xmark 0xf0002/0xffffffff
-A nm_mdmprxy_pkt_marker -p udp -m udp --dport 5060 -j MARK --set-xmark 0xf0002/0xffffffff
-A nm_mdmprxy_pkt_marker -m mark --mark 0xf0002 -j nm_mdmprxy_pkt_forwarder
-A nm_mdmprxy_pkt_marker ! -p icmp -m mark --mark 0xf0002 -j DROP
-A nm_mdmprxy_pkt_skmark -j RETURN
-A qcom_qos_reset_POSTROUTING -o rmnet_data+ -j MARK --set-xmark 0x0/0xffffffff
-A routectrl_mangle_INPUT -i rmnet_data0 -j MARK --set-xmark 0x30068/0xffefffff
-A routectrl_mangle_INPUT -i wlan0 -j MARK --set-xmark 0x30063/0xffefffff
-A tetherctrl_mangle_FORWARD -p tcp -m tcp --tcp-flags SYN SYN -j TCPMSS --clamp-mss-to-pmtu
COMMIT
# Completed on Fri Sep 29 18:29:03 2023
# Generated by iptables-save v1.8.7 on Fri Sep 29 18:29:03 2023
*filter
:INPUT ACCEPT [548:49782]
:FORWARD ACCEPT [1225:87800]
:OUTPUT ACCEPT [412:70141]
:bw_FORWARD - [0:0]
:bw_INPUT - [0:0]
:bw_OUTPUT - [0:0]
:bw_costly_rmnet_data0 - [0:0]
:bw_costly_shared - [0:0]
:bw_data_saver - [0:0]
:bw_global_alert - [0:0]
:bw_happy_box - [0:0]
:bw_penalty_box - [0:0]
:fw_FORWARD - [0:0]
:fw_INPUT - [0:0]
:fw_OUTPUT - [0:0]
:fw_dozable - [0:0]
:fw_isolated - [0:0]
:fw_powersave - [0:0]
:fw_standby - [0:0]
:nm_mdmprxy_doze_mode_skip - [0:0]
:nm_mdmprxy_iface_pkt_fwder - [0:0]
:oem_fwd - [0:0]
:oem_out - [0:0]
:st_OUTPUT - [0:0]
:st_clear_caught - [0:0]
:st_clear_detect - [0:0]
:st_penalty_log - [0:0]
:st_penalty_reject - [0:0]
:tetherctrl_FORWARD - [0:0]
:tetherctrl_counters - [0:0]
-A INPUT -j bw_INPUT
-A INPUT -j fw_INPUT
-A FORWARD -j oem_fwd
-A FORWARD -j fw_FORWARD
-A FORWARD -j bw_FORWARD
-A FORWARD -j tetherctrl_FORWARD
-A OUTPUT -o r_rmnet_data8 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o r_rmnet_data7 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o r_rmnet_data6 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o r_rmnet_data5 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o r_rmnet_data4 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o r_rmnet_data3 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o r_rmnet_data2 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o r_rmnet_data1 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o r_rmnet_data0 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o rmnet_data7 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o rmnet_data6 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o rmnet_data5 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o rmnet_data4 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o rmnet_data3 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o rmnet_data2 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o rmnet_data1 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -o rmnet_data0 -p udp -m udp --dport 1900 -j DROP
-A OUTPUT -j oem_out
-A OUTPUT -j fw_OUTPUT
-A OUTPUT -j st_OUTPUT
-A OUTPUT -j bw_OUTPUT
-A bw_FORWARD -i rmnet_data0 -j bw_costly_rmnet_data0
-A bw_FORWARD -o rmnet_data0 -j bw_costly_rmnet_data0
-A bw_INPUT -j bw_global_alert
-A bw_INPUT -i rmnet_data0 -j bw_costly_rmnet_data0
-A bw_INPUT -p esp -j RETURN
-A bw_INPUT -m mark --mark 0x100000/0x100000 -j RETURN
-A bw_INPUT -m owner --socket-exists
-A bw_INPUT -j MARK --set-xmark 0x100000/0x100000
-A bw_OUTPUT -j bw_global_alert
-A bw_OUTPUT -o rmnet_data0 -j bw_costly_rmnet_data0
-A bw_OUTPUT -o ipsec+ -j RETURN
-A bw_OUTPUT -m policy --dir out --pol ipsec -j RETURN
-A bw_OUTPUT -m owner --uid-owner 1029 -j RETURN
-A bw_OUTPUT -m owner --socket-exists
-A bw_costly_rmnet_data0 -j bw_penalty_box
-A bw_costly_rmnet_data0